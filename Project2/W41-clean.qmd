---
title: Exercises week 41
subtitle: FYS-STK4155
author: Even Sletteng Garvang
format: pdf
---


```{python}
import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error

from utils import *
```

```{python}
def data_function(x):
    return 4*x**3 + x**2 - 17*x + 48

np.random.seed(8923)

# generate data
n = 100
x = np.linspace(-2, 2, n)
f_x = data_function(x)
y = f_x + np.random.normal(0, 1, n)
y = y.reshape(-1,1)

# create design matrix of polynomials
# for now 3rd order reflecting data function
X = PolynomialFeatures(5).fit_transform(x.reshape(-1, 1))

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)


plt.plot(x, y, "o")
plt.show()
```

```{python}
eta = 0.001
n_iter = 1000
GD(X, y, eta, n_iter)
GD(X, y, eta, n_iter, gradient_fun=gradient_ridge, gradient_args={"lmb":0.1})
```


```{python}
eta = 0.001
n_iter = 1000
lmbs=np.logspace(-5,0,6)
mse=np.zeros(len(lmbs))

for i in range(len(lmbs)):
    theta = GD(X_train, y_train, eta, n_iter, gradient_fun=gradient_ridge, gradient_args={"lmb":lmbs[i]})
    y_pred = X_test @ theta
    mse[i] = mean_squared_error(y_test, y_pred)

print(mse)
    

```